<!DOCTYPE html>
<html lang="ja">
<head>
  
    <title>ブラウザからforkすると遅いのでCLIからfork &amp; cloneするスクリプトを書いた :: blog.kyu08.com</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="モチベーション GitHubにホストされているOSSにPRを出す時にforkしてからローカルにcloneするが、ブラウザのforkボタンを使っ" />
<meta name="keywords" content="GitHub, cli, zsh" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://blog.kyu08.com/posts/gh-repo-fork-script/" />


<script async src="https://www.googletagmanager.com/gtag/js?id=G-BDQ408J45J"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-BDQ408J45J', { 'anonymize_ip': false });
}
</script>





  
  
  
  
  
  <link rel="stylesheet" href="https://blog.kyu08.com/styles.css">



<link rel="stylesheet" href="https://blog.kyu08.com/style.css">



  <link rel="shortcut icon" href="https://blog.kyu08.com/favicon.ico">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="kyu08_" />



<meta property="og:locale" content="ja" />
<meta property="og:type" content="article" />
<meta property="og:title" content="ブラウザからforkすると遅いのでCLIからfork &amp; cloneするスクリプトを書いた">
<meta property="og:description" content="モチベーション GitHubにホストされているOSSにPRを出す時にforkしてからローカルにcloneするが、ブラウザのforkボタンを使っ" />
<meta property="og:url" content="https://blog.kyu08.com/posts/gh-repo-fork-script/" />
<meta property="og:site_name" content="blog.kyu08.com" />

  
  
  <meta property="og:image" content="https://blog.kyu08.com/cover.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2024-08-18 15:52:01 &#43;0900 &#43;0900" />









<link rel="author" href="http://www.hatena.ne.jp/kyu08/" />




<script async src="https://www.googletagmanager.com/gtag/js?id=G-BDQ408J45J"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '{{ . }}');
</script>




</head>
<body class="orange">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    blog.kyu08.com
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/index.xml">RSS</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about" >About</a></li>
        
      
        
          <li><a href="/index.xml" >RSS</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://blog.kyu08.com/posts/gh-repo-fork-script/">ブラウザからforkすると遅いのでCLIからfork &amp; cloneするスクリプトを書いた</a>
  </h1>
  <div class="post-meta">
    
      <time class="post-date">
        2024-08-18 ::
        
      </time>
    
    
      <span class="post-author">kyu08</span>
    
    
      <span class="post-reading-time">:: 2 min read (755 words)</span>
    
  </div>

  
    <span class="post-tags">
      
      #<a href="https://blog.kyu08.com/tags/github/">GitHub</a>&nbsp;
      
      #<a href="https://blog.kyu08.com/tags/cli/">cli</a>&nbsp;
      
      #<a href="https://blog.kyu08.com/tags/zsh/">zsh</a>&nbsp;
      
    </span>
  
  
  <img src="https://blog.kyu08.com/cover.png"
    class="post-cover"
    alt="ブラウザからforkすると遅いのでCLIからfork &amp; cloneするスクリプトを書いた"
    title="Cover Image" />


  
    <div class="table-of-contents">
      <h2>
        目次
      </h2>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#モチベーション">モチベーション</a></li>
    <li><a href="#つくったスクリプト">つくったスクリプト</a></li>
    <li><a href="#前提">前提</a></li>
    <li><a href="#使い方">使い方</a></li>
    <li><a href="#まとめ">まとめ</a></li>
  </ul>
</nav>
    </div>
  

  <div class="post-content"><div>
        <h2 id="モチベーション">モチベーション<a href="#モチベーション" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<!-- raw HTML omitted -->
<p>GitHubにホストされているOSSにPRを出す時にforkしてからローカルにcloneするが、ブラウザのforkボタンを使ってforkすると時間がかかることが多くストレスに感じていた。</p>
<!-- raw HTML omitted -->
<p>そのためCLI上でforkとcloneを行うスクリプトを書いた。</p>
<p>これまでの手順は以下のような手順が必要だった。</p>
<ol>
<li>ブラウザでforkボタンを押す</li>
<li>forkの完了を待つ</li>
<li>ブラウザに表示されるcloneコマンドをコピー(<code>gh repo clone owner/repo</code>みたいなやつ)</li>
<li>ターミナルでコマンドを実行してforkしたリポジトリをcloneする</li>
</ol>
<p>これを以下のステップでできるようにした。</p>
<ol>
<li>リポジトリのURLまたは<code>OWNER/REPO</code>形式の文字列をコピー</li>
<li>コマンドに1. で取得した文字列を渡して実行</li>
</ol>
<h2 id="つくったスクリプト">つくったスクリプト<a href="#つくったスクリプト" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>以下を<code>.zshrc</code>などに追加すると使えるようになる。<code>alias</code>の部分はお好みで。<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> git-fork-clone<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 入力からowner/repoを取り出す。owner/repoのような形式でもURLでもOK</span>
</span></span><span style="display:flex;"><span>    REPO<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo $1 | sed -E <span style="color:#e6db74">&#39;s@.+github.com/([^/]+)/([^/]+).*@\1/\2@&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;🐙 </span><span style="color:#e6db74">${</span>REPO<span style="color:#e6db74">}</span><span style="color:#e6db74"> will be forked and cloned.\\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># -- 以降のオプションはgit cloneに渡される</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># See: https://cli.github.com/manual/gh_repo_fork</span>
</span></span><span style="display:flex;"><span>    gh repo fork <span style="color:#e6db74">${</span>REPO<span style="color:#e6db74">}</span> --default-branch-only --clone<span style="color:#f92672">=</span>true -- --depth<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>alias gf<span style="color:#f92672">=</span>git-fork-clone
</span></span></code></pre></div><h2 id="前提">前提<a href="#前提" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p><code>gh</code>コマンドがインストールされていること。</p>
<h2 id="使い方">使い方<a href="#使い方" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git-fork-clone https://github.com/cli/cli
</span></span></code></pre></div><p>上記を実行すると以下のような出力が表示され、リポジトリのforkとcloneが行われる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>🐙 cli/cli will be forked and cloned.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>✓ Created fork kyu08/cli
</span></span><span style="display:flex;"><span>Cloning into <span style="color:#e6db74">&#39;cli&#39;</span>...
</span></span><span style="display:flex;"><span>remote: Enumerating objects: 31, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Counting objects: 100% <span style="color:#f92672">(</span>31/31<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Compressing objects: 100% <span style="color:#f92672">(</span>30/30<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Total <span style="color:#ae81ff">31</span> <span style="color:#f92672">(</span>delta 0<span style="color:#f92672">)</span>, reused <span style="color:#ae81ff">10</span> <span style="color:#f92672">(</span>delta 0<span style="color:#f92672">)</span>, pack-reused <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>from 0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Receiving objects: 100% <span style="color:#f92672">(</span>31/31<span style="color:#f92672">)</span>, 20.41 KiB | 10.20 MiB/s, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>From github.com:cli/cli
</span></span><span style="display:flex;"><span> * <span style="color:#f92672">[</span>new branch<span style="color:#f92672">]</span>      main       -&gt; upstream/main
</span></span><span style="display:flex;"><span> * <span style="color:#f92672">[</span>new tag<span style="color:#f92672">]</span>         v1.0.1     -&gt; v1.0.1
</span></span><span style="display:flex;"><span>✓ Cloned fork
</span></span></code></pre></div><p>以下のような形式でも動く。</p>
<ul>
<li><code>git-fork-clone https://github.com/cli/cli/pulls</code></li>
<li><code>git-fork-clone cli/cli</code></li>
</ul>
<h2 id="まとめ">まとめ<a href="#まとめ" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>また人類のOSS貢献力を加速させてしまいました。</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>完全に余談だがスクリプトの<code>REPO=...</code>の部分は <a href="https://www.tutorialspoint.com/execute_bash_online.php" target="_blank" >https://www.tutorialspoint.com/execute_bash_online.php</a>
 を使って出先で書いた。スマホでもシェルスクリプトが書けて便利。&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="https://blog.kyu08.com/posts/technical-writing-book/">
                <span class="button__text">『読み手につたわる文章 - テクニカルライティング』を読んだ</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    <script src="https://utteranc.es/client.js"
        repo="kyu08/blog-comments"
        issue-term="pathname"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>blog.kyu08.com</span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>


<font color="#808080">
  <span>
    This site uses Google Analytics for access analysis.
    Google Analytics uses cookies to collect traffic data, but this traffic data is collected anonymously and does not personally identify you.
    Cookies can be disabled in your browser.
  </span>
</font>


  
</div>

</body>
</html>
